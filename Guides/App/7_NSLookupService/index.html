<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>7 - NSLookupService - GNUstep</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">GNUstep</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">GNUstep</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../APIRefs/index.html">API references</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API references</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../APIRefs/Make/index.html">Make</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Make</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../APIRefs/Make/Introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../APIRefs/Make/Topics/index.html">Topics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/Topics/Subproject.html">Subprojects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/Topics/MultipleTypes.html">Building more than one thing in the same GNUmakefile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/Topics/Aggregate.html">Aggregate projects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/Topics/ParallelBuilding.html">Parallel Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/Topics/LibraryIntroduction.html">Introduction to Libraries</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/index.html">Project Types</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Project Types</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/Project.html">Project reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/ResourceSet.html">Resource Set reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/Tool.html">Tool reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/Application.html">Application reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/ProjectTypes/Library.html">Library reference</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../APIRefs/Make/OtherVariables/index.html">Other Variables</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Other Variables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../APIRefs/Make/OtherVariables/Flags.html">Overridable Flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../APIRefs/Make/ReleaseNotes.html">Release Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../APIRefs/Base/index.html">GNUstep Base</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/Guides/App/7_NSLookupService/index.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="nslookupservice">
<h1>7 - NSLookupService<a class="headerlink" href="#nslookupservice" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="http://developer.apple.com/documentation/Cocoa/Conceptual/SysServices/index.html">System
service</a>
is an important feature of GNUstep, which connects applications
together. The basic idea is that any application can be a service
provider. Service provider will offer some functions for other
applications. Through service menu, one application can use the
functions of other applications. They can also exchange the data
in-between. GNUstep offer several basic service by default. Try open
<span class="APPLICATION">Ink.app</span>. Type something, select some
word, choose menu “Services-&gt;To upper”, then selected word change to
upper case. The function of converting letter into upper case is
provider by <span class="APPLICATION">exampleService</span>, not <span
class="APPLICATION">Ink</span>. Ink simply send the word to
exampleService and get the result back. Through system service, you can
simply throw an email address in the document to a mail client, throw
the url in the document to web browser, or throw the image in
imageviewer to a filter and get the result back. With system service,
applications can concentrate more on its own and communicate with other
applications to expand the functions.</p>
<p>Firstly, let’s start with an application which can use system service.
I’ll make an simple application which can look up the address of a
hostname. That’s the graphic version of <strong>nslookup</strong>.</p>
<p>Open Gorm, make an interface looks like this:</p>
<p><strong>Figure 5-1. Interface of NSLookupService</strong></p>
<p><img alt="" src="../../../_images/NSLookupService-01.jpg" /></p>
<p>Create a subclass of NSObject called “Controller”, and add two outlets:
“hostname” and “address”. Connect the outlet to the NSTextField in the
interface.</p>
<p><strong>Figure 5-2. Connect outlet</strong></p>
<p><img alt="" src="../../../_images/NSLookupService-02.jpg" /></p>
<p>Add an action called “action:” in Controller and connect action of
NSTextField to “action:”</p>
<p><strong>Figure 5-3. Connect action.</strong></p>
<p><img alt="" src="../../../_images/NSLookupService-03.jpg" /></p>
<p>Connect delegate of NSOwner (NSApp in this case) to Controller since
service is associated with NSApp. It will be useful in the later.</p>
<p><strong>Figure 5-4. Connect delegate of NSApp</strong></p>
<p><img alt="" src="../../../_images/NSLookupService-04.jpg" /></p>
<p>Modify Controller.m</p>
<p><code class="docutils literal notranslate"><span class="pre">Controller.m</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">action:</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">sender</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">address</span><span class="w"> </span><span class="n">setStringValue</span><span class="o">:</span><span class="w"> </span><span class="p">[[</span><span class="n">NSHost</span><span class="w"> </span><span class="n">hostWithName</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">hostname</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]]</span><span class="w"> </span><span class="n">address</span><span class="p">]];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It takes the value in hostname text field and convert into the address.</p>
<p>Now, I want this application be able to use system service provided by
other applications. I only need to add a menu so that menu of system
service can shows up.</p>
<p><code class="docutils literal notranslate"><span class="pre">Controller.m</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">awakeFromNib</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">NSMenu</span><span class="w"> </span><span class="o">*</span><span class="n">mainMenu</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">serviceMenu</span><span class="p">;</span>

<span class="w">  </span><span class="n">mainMenu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">mainMenu</span><span class="p">];</span>

<span class="w">  </span><span class="p">[</span><span class="n">mainMenu</span><span class="w"> </span><span class="n">insertItemWithTitle</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;Services&quot;</span>
<span class="w">                         </span><span class="nl">action</span><span class="p">:</span><span class="w"> </span><span class="nb">NULL</span>
<span class="w">                  </span><span class="nl">keyEquivalent</span><span class="p">:</span><span class="w"> </span><span class="s">@&quot;&quot;</span>
<span class="w">                        </span><span class="nl">atIndex</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span>

<span class="w">  </span><span class="n">serviceMenu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">NSMenu</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithTitle</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;Services&quot;</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">mainMenu</span><span class="w"> </span><span class="n">setSubmenu</span><span class="o">:</span><span class="w"> </span><span class="n">serviceMenu</span>
<span class="w">               </span><span class="nl">forItem</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">mainMenu</span><span class="w"> </span><span class="n">itemWithTitle</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;Services&quot;</span><span class="p">]];</span>
<span class="w">  </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">setServicesMenu</span><span class="o">:</span><span class="w"> </span><span class="n">serviceMenu</span><span class="p">];</span>
<span class="w">  </span><span class="n">RELEASE</span><span class="p">(</span><span class="n">serviceMenu</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After the Gorm interface is loaded, add a Services menu. The most
important is to assign this menu as the service menu of NSApp. Now,
start this application, type something in the NSTextField, and default
services can be used. The service menu changes depending on the object
you select. If there is no selection, there is no item in the service
menu.</p>
<p>Now, I can provide the service for other applications. Only two things
are need: one is to write the interface of system service, the other is
to implement the system service. The interface of system service is in
the property list of the application. In this case, it is
NSLookupServiceInfo.plist since I name this application as
NSLookupServiceInfo.</p>
<p><code class="docutils literal notranslate"><span class="pre">NSLookupServiceInfo.plist</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="n">NSServices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">NSPortName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSLookupService</span><span class="p">;</span>
<span class="w">      </span><span class="n">NSMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAddress</span><span class="p">;</span>
<span class="w">      </span><span class="n">NSSendTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">NSStringPboardType</span><span class="p">);</span>
<span class="w">      </span><span class="n">NSMenuItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Get Address&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">English</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Get Address&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">      </span><span class="n">NSKeyEquivalent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;G&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In property list, NSPortName is the name of the application. NSMessage
is the method I need to implement later. NSSendTypes is the type of
pasteboard to use when other application want to send data to this
application. In other word, this application only accept
NSStringPboardType, not other data type. NSMenuItem and NSKeyEquivalent
is the menu which will show up in the service menu of all the
applications. The menu will show up only when the selection is the type
of string.</p>
<p>As the NSMessage is getAddress, I have to implement getAddress method.
The interface of this method is fixed as:</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">getAddress:</span><span class="w"> </span><span class="p">(</span><span class="n">NSPasteboard</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">pboard</span>
<span class="w">           </span><span class="nl">userData</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">userData</span>
<span class="w">              </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">**</span><span class="p">)</span> <span class="nv">error</span>
</pre></div>
</div>
<p>getAddress: is the name the same as NSMessage. pboard is the pasteboard
which contain the data from other applications. userData is the string
if you have NSUserData in the property list of NSServices. error is the
error message you want to shows up if something wrong.</p>
<p>Now, let’s implement this method in Controller.m</p>
<p><code class="docutils literal notranslate"><span class="pre">Controller.m</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">getAddress:</span><span class="w"> </span><span class="p">(</span><span class="n">NSPasteboard</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">pboard</span>
<span class="w">           </span><span class="nl">userData</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">userData</span>
<span class="w">              </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">**</span><span class="p">)</span> <span class="nv">error</span>
<span class="p">{</span>
<span class="w">  </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">allTypes</span><span class="p">;</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>
</pre></div>
</div>
<p>Check whether pasteboard reall contain NSString type. If not, show the
error.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">allTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">types</span><span class="p">];</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="p">[</span><span class="n">allTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;No string type supplied by pasteboard&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Get the string out of pasteboard. If there is no string, show the error.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">stringForType</span><span class="o">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">];</span><span class="w"> </span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;No string value supplied by pasteboard&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Put the hostname into the NSTextField, check whether it is valid. If
not, show the error. Use -action: to get the address</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">[</span><span class="n">hostname</span><span class="w"> </span><span class="n">setStringValue</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">([[</span><span class="n">NSHost</span><span class="w"> </span><span class="n">hostWithName</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="n">address</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;Host name is not valid&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">action</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, I have to let NSApp know which object in this application
provides the service.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">applicationDidFinishLaunching:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSNotification</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">not</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">NSApp</span><span class="w"> </span><span class="n">setServicesProvider</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In other word, you can have an object specialized for providing service.</p>
<p>You have to install this application to make the service work, and you
have to run <strong>make_services</strong> so that GNUstep can know there is a new
service. <strong>make_services</strong> is a tool of GNUstep, and is called in
GNUstep.sh or GNUstep.csh. Therefore, everytime you login, it is called
automatically. If you install new application which offer system
service, you must manually run <strong>make_services</strong> or login again.</p>
<p>After runing <strong>make_services</strong>, open <span
class="APPLICATION">Ink</span>. Type something and select them. Now,
service menu of Ink should show the service provide by NSLookupService.
Choose the menu, and NSLookupService will start automatically. If the
selected string is valid hostname, NSLookupService will show its
address, otherwise, Ink will show the error message provided by
NSLookupService.</p>
<p>If I want to get the value back from NSLookupService, it’s easy. Add the
return type in property list:</p>
<p><code class="docutils literal notranslate"><span class="pre">NSLookupServiceInfo.plist</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="n">NSServices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">NSPortName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSLookupService</span><span class="p">;</span>
<span class="w">      </span><span class="n">NSMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAddress</span><span class="p">;</span>
<span class="w">      </span><span class="n">NSSendTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">NSStringPboardType</span><span class="p">);</span>
<span class="w">      </span><span class="n">NSReturnTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">NSStringPboardType</span><span class="p">);</span>
<span class="w">      </span><span class="n">NSMenuItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Get Address&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">English</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Get Address&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">      </span><span class="n">NSKeyEquivalent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;G&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The return type is also string in this case. In the end of -getAddress:,
I just need to put the return value back into the pasteboard. Whatever
application use this service will get the return value from the
pasteboard.</p>
<p><code class="docutils literal notranslate"><span class="pre">Controller.m</span></code></p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">getAddress:</span><span class="w"> </span><span class="p">(</span><span class="n">NSPasteboard</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">pboard</span>
<span class="w">           </span><span class="nl">userData</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">userData</span>
<span class="w">              </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">**</span><span class="p">)</span> <span class="nv">error</span>
<span class="p">{</span>
<span class="w">  </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">allTypes</span><span class="p">;</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>

<span class="w">  </span><span class="n">allTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">types</span><span class="p">];</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="p">[</span><span class="n">allTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;No string type supplied by pasteboard&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">stringForType</span><span class="o">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">];</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;No string value supplied by pasteboard&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="p">[</span><span class="n">hostname</span><span class="w"> </span><span class="n">setStringValue</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">([[</span><span class="n">NSHost</span><span class="w"> </span><span class="n">hostWithName</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="n">address</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;Host name is not valid&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">action</span><span class="o">:</span><span class="w"> </span><span class="nb">self</span><span class="p">];</span>
<span class="w">  </span><span class="cm">/* For return value */</span>
<span class="w">  </span><span class="n">allTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSArray</span><span class="w"> </span><span class="n">arrayWithObject</span><span class="o">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">declareTypes</span><span class="o">:</span><span class="w"> </span><span class="n">allTypes</span><span class="w"> </span><span class="n">owner</span><span class="o">:</span><span class="w"> </span><span class="nb">nil</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">pboard</span><span class="w"> </span><span class="n">setString</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="w"> </span><span class="s">@&quot;%@ (%@)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">address</span><span class="w"> </span><span class="n">stringValue</span><span class="p">]]</span>
<span class="w">            </span><span class="nl">forType</span><span class="p">:</span><span class="w"> </span><span class="n">NSStringPboardType</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, I return the original string with its address appended.
You can test it in <span class="APPLICATION">Ink</span> again.</p>
<p>Here is the source code:
<a class="reference external" href="http://gnustep.made-it.com/GSPT/NSLookupService/NSLookupService-src.tar.gz">NSLookupService-src.tar.gz</a></p>
<hr class="docutils" />
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, GNUstep contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    </body>
</html>